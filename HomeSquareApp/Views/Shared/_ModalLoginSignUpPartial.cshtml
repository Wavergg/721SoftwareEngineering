
<div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                
            </div>
            <div class="login-wrap">
                
                <div class="login-html">
                    <input id="tab-1" type="radio" name="tab" class="sign-in" checked><label for="tab-1" class="tab" style="cursor:pointer">Sign In</label>
                    <input id="tab-2" type="radio" name="tab" class="sign-up"><label for="tab-2" class="tab" style="cursor:pointer">Sign Up</label>
                    <div class="login-form">
                        <div class="sign-in-htm">
                            @* SignIn AREA *@
                            @* ---------------------------------------------- *@
                            <form>
                                <div style="background-color: #ffcccb">
                                    <p id="signupConfirmationPrompt" class="p-3 form-text d-none">
                                        Email Validation has been sent to <span id="userEmail">ultimateformj@gmail.com</span><br/>
                                        @*Did not receive any email? <a href="#" class="text-decoration-underline">Resend link</a>*@
                                    </p>
                                </div>
                                <div class="group">
                                    <label for="emailLogIn" class="label">Email</label>
                                    <input id="emailLogIn" type="email" class="input" required>
                                </div>
                                <div class="group">
                                    <label for="pass" class="label">Password</label>
                                    <input id="passLogIn" type="password" class="input" data-type="password" required>
                                </div>
                                @*<div class="group">
            <input id="check" type="checkbox" class="check" checked>
            <label for="check"><span class="icon"></span> Keep me Signed in</label>
        </div>*@
                                <div class="group">
                                    <button type="submit" class="btn btn-primary form-control rounded-pill"> Sign In</button>
                                </div>
                            </form>
                            <div class="foot-lnk">
                                <a href="#forgot">Forgot Password?</a>
                            </div>
                        </div>
                        @* SignUp / Register AREA *@
                        @* ---------------------------------------------- *@
                        <div class="sign-up-htm">
                            <span id="progressBarPrompt">1/2</span>
                            <div class="progress mb-3" style="height: 1px;">
                                <div id="progressBarLogin" class="progress-bar" role="progressbar" style="width: 50%;" aria-valuenow="50" aria-valuemin="0" aria-valuemax="100"></div>
                            </div>
                            <form>
                                <div id="signUpGroup1">
                                    <div class="group">
                                        <label for="emailSignup" class="label">Email Address</label>
                                        <input onchange="validateEmail(this.value)" id="emailSignup" type="email" class="input" required>
                                        <span id="emailSignupValidPrompt" class="form-text"></span>
                                    </div>
                                    <div class="group">
                                        <label for="passwordSignup" class="label">Password</label>
                                        <input onchange="validatePassword(this.value)" id="passwordSignup" type="password" class="input" data-type="password" required>
                                        <div id="passwordSignupValidPrompt" class="form-text">Password should be at least 8 characters and contain atleast 1 numeric character</div>
                                    </div>
                                    <div class="group">
                                        <label for="confirmPassSignup" class="label">Repeat Password</label>
                                        <input onchange="validateRepeatPassword()" id="confirmPasswordSignup" type="password" class="input" data-type="password" required>
                                        <span id="confirmPasswordSignupValidPrompt" class="text-danger form-text"></span>
                                    </div>
                                    <div class="group">
                                        <button type="button" onclick="nextSignup()" class="btn btn-primary form-control rounded-pill">Next</button>
                                    </div>
                                </div>
                                <div id="signUpGroup2" class="d-none">
                                    <div class="group">
                                        <label for="firstNameSignup" class="label">First Name</label>
                                        <input id="firstNameSignup" type="text" class="input" required>
                                        <span class="text-danger form-text"></span>
                                    </div>
                                    <div class="group">
                                        <label for="lastNameSignup" class="label">Last Name</label>
                                        <input id="lastNameSignup" type="text" class="input" required>
                                        <span class="text-danger form-text"></span>
                                    </div>
                                    <div class="group">
                                        <label for="addressSignup" class="label">Address</label>
                                        <input id="addressSignup" type="text" class="input" required>
                                        <span class="text-danger form-text"></span>
                                    </div>
                                    <div class="group">
                                        <label for="phoneSignup" class="label">Phone Number</label>
                                        <input id="phoneSignup" type="text" class="input" required>
                                        <span class="form-text"></span>
                                    </div>
                                    <div class="form-check">
                                        <input onchange="confirmCheckBoxChange(this)" class="form-check-input" type="checkbox" id="confirmCheckChecked" required>
                                        <label id="labelConfirmCheckChecked" class="form-check-label form-text" for="confirmCheckChecked">
                                            I am ready to receive email to activate my account
                                        </label>
                                    </div>
                                    <div class="group mt-2">
                                        <button onclick="backSignup()" class="btn btn-light border border-dark form-control rounded-pill">Back</button>
                                    </div>
                                    <div class="group">
                                        <input onclick="submitSignupForm()" class="btn btn-primary form-control rounded-pill" value="Sign Up" />
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<script>
    function submitSignupForm() {

        var emailElement = document.getElementById('emailSignup');
        var passwordElement = document.getElementById('passwordSignup')
        var confirmPasswordElement = document.getElementById('confirmPasswordSignup');
        
        var firstNameElement = document.getElementById('firstNameSignup');
        var lastNameElement = document.getElementById('lastNameSignup');
        var addressElement = document.getElementById('addressSignup');
        var phoneElement = document.getElementById('phoneSignup');
        var confirmForm = document.getElementById('confirmCheckChecked');

        if (!confirmForm.checked) {
            labelConfirmCheckChecked.classList.add('text-danger');
            confirmForm.classList.add('border-danger');
            return;
        }

        if (checkEmptyValue(firstNameElement) && checkEmptyValue(lastNameElement) &&
            checkEmptyValue(addressElement) && checkEmptyValue(phoneElement) )
        {
            //NYD Send data here, WITH AJAX

            $.ajax({
                url: "Login/SendEmail",
                data: { email: emailElement.value}
            }).done(function () {
                
            });

            document.getElementById('tab-1').click();
            document.getElementById('signupConfirmationPrompt').classList.remove('d-none');
        }
    }

    
    function nextSignup() {
        var emailElement = document.getElementById('emailSignup');
        var passwordElement = document.getElementById('passwordSignup')
        var confirmPasswordElement = document.getElementById('confirmPasswordSignup');

        if (checkEmptyValue(emailElement) && checkEmptyValue(passwordElement) && checkEmptyValue(confirmPasswordElement)) {
            //make the other group visible and the current group not visible
            if (validateEmail(emailElement.value) && validatePassword(passwordElement.value) && validateRepeatPassword()) {
                document.getElementById('progressBarPrompt').innerHTML = "2/2";
                document.getElementById('progressBarLogin').style.width = "100%";
                document.getElementById('signUpGroup1').classList.add('d-none');
                document.getElementById('signUpGroup2').classList.remove('d-none');
            }
        }
        return;
    }

    function confirmCheckBoxChange(checkboxElement) {
        var confirmForm = document.getElementById('confirmCheckChecked');
        if (!checkboxElement.checked) {
            labelConfirmCheckChecked.classList.add('text-danger');
            confirmForm.classList.add('border-danger');
        } else {
            labelConfirmCheckChecked.classList.remove('text-danger');
            confirmForm.classList.remove('border-danger');
        }
    }

    //return true if value is not empty
    function checkEmptyValue(element) {
        if (!element.value) {
            element.classList.add('border');
            element.classList.add('border-danger');
            return false;
        } 
        element.classList.remove('border');
        element.classList.remove('border-danger');
        return true;
    }

    function backSignup() {
        document.getElementById('progressBarPrompt').innerHTML = "1/2";
        document.getElementById('progressBarLogin').style.width = "50%";
        document.getElementById('signUpGroup1').classList.remove('d-none');
        document.getElementById('signUpGroup2').classList.add('d-none');
    }

    function validateEmail(email) {
        const re = /^(([^<>()[\]\\.,;:\s@@"]+(\.[^<>()[\]\\.,;:\s@@"]+)*)|(".+"))@@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
        var result = re.test(String(email).toLowerCase());
        var el = document.getElementById('emailSignupValidPrompt');

        if (!result) {
            el.classList.add('text-danger');
            el.innerHTML = "Invalid email address";
            return false;
        } else {
            el.innerHTML = "";
            return true;
        }
    }

    function validatePassword(password) {
        const re = /^(?=.*[0-9])(?=.{8,})/;
        var result = re.test(String(password));
        var el = document.getElementById('passwordSignupValidPrompt');
        if (!result) {
            el.classList.remove('text-success');
            el.classList.add('text-danger');
            return false;
        }
        el.classList.remove('text-danger');
        el.classList.add('text-success');
        return true;
    }

    function validateRepeatPassword() {
        var passwordEl = document.getElementById('passwordSignup');
        var confirmPasswordEl = document.getElementById('confirmPasswordSignup');

        console.log(passwordEl.value + " " + confirmPasswordEl.value)

        if (passwordEl.value != confirmPasswordEl.value) {
            confirmPasswordSignupValidPrompt.innerHTML = "Password and the confirmation did not match";
            return false;
        }
        confirmPasswordSignupValidPrompt.innerHTML = "";
        return true;
    }
</script>