const steps = Array.from(document.querySelectorAll("form .step")), nextBtn = document.querySelectorAll("form .next-btn"), prevBtn = document.querySelectorAll("form .prev-btn"), form = document.querySelector("form"), progressBarCheckout = document.getElementById("progressCheckout"), progressBarCheckoutPrompt = document.getElementById("progressBarCheckoutPrompt"); var deliveryOptionsRadio = document.checkoutForm.deliveryOptions, deliveryAddressEl = document.getElementById("DeliveryAddress"), deliveryAddressStoredVal = deliveryAddressEl.value, validateDetailsElements = document.getElementsByClassName("validateDetails"); function changeStep(e) { let t = 0; const r = document.querySelector("form .active"); t = steps.indexOf(r), steps[t].classList.remove("active"), "next" === e ? t++ : t--, progressBarCheckoutPrompt.innerHTML = `${t + 1}/${steps.length}`, progressBarCheckout.style.width = `${50 * (t + 1)}%`, steps[t].classList.add("active"), window.scrollTo({ top: 0, behavior: "smooth" }) } deliveryOptionsRadio.forEach(e => { e.addEventListener("change", t => { "pickup" == e.id ? document.getElementById("DeliveryInfo").classList.add("d-none") : document.getElementById("DeliveryInfo").classList.remove("d-none") }) }), nextBtn.forEach(e => { e.addEventListener("click", e => { changeStep("next") }) }), prevBtn.forEach(e => { e.addEventListener("click", e => { changeStep("prev") }) }); var input = $("input[name = creditCardNumber]"); function limitLength(e, t) { e.value.length > t && (e.value = e.value.substr(0, e.value.length - 1)) } function formatCreditCard(e) { var t = e.value.lastIndexOf("-"); 4 === e.value.substr(t + 1).length && e.value.length < 16 && (e.value = e.value + "-") } function updateDeliveryAddress(e) { "Pickup" == e.value ? deliveryAddressEl.value = "PICKUP" : deliveryAddressEl.value = deliveryAddressStoredVal } function checkoutReturned(e) { if (e.responseJSON.isSuccess) window.location.href = e.responseJSON.urlRedirect; else { for (var t = document.createElement("ul"), r = 0; r < e.responseJSON.message.length; r++) { var n = document.createElement("li"); n.appendChild(document.createTextNode(e.responseJSON.message[r])), t.appendChild(n) } document.getElementById("errorCheckoutSummary").innerHTML = "", document.getElementById("errorCheckoutSummary").appendChild(t), app.updateOrderSummary(), app.getCurrentCartCount(), app.loadCart() } } input.on("keypress", function () { limitLength(this, 18); var e = event.keyCode || event.charCode; 8 != e && 46 != e && formatCreditCard(this) });